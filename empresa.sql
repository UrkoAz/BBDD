DROP DATABASE IF EXISTS EMPRESA;
CREATE DATABASE EMPRESA;

USE EMPRESA;

CREATE TABLE ONG(
    ID_ONG INT NOT NULL,
    TLF_ONG INT(9) NOT NULL,
    DIR_ONG VARCHAR(50) NOT NULL,
    ID_EMPRESA INT NOT NULL
);

CREATE TABLE EMPRESA(
    ID_EMPRESA INT NOT NULL,
    NOMBRE_EMPRE TEXT NOT NULL,
    DIR_EMPR VARCHAR(50) NOT NULL,
    TLF_EMPR INT(9) NOT NULL
);

CREATE TABLE DEPARTAMENTO(
    ID_DEP INT NOT NULL,
    NOMBRE_DEP TEXT NOT NULL,
    NUM_TRAB INT NOT NULL,
    ID_EMPRESA INT NOT NULL
);

CREATE TABLE EMPLEADOS(
    ID_EMPLEADOS INT NOT NULL,
    NOMBRE_EMPL TEXT NOT NULL,
    TLF_EMPL INT(9) NOT NULL,
    SALARIO INT(4) NOT NULL,
    DIR_EMPL VARCHAR(50) NOT NULL,
    SEXO TEXT NOT NULL,
    FECHA_NAC_EMPL DATE NOT NULL,
    ID_DEP INT NOT NULL
);

CREATE TABLE REPARA(
    FECHA_HORA DATETIME NOT NULL,
    ID_EMPLEADOS INT NOT NULL,
    ID_DISP INT NOT NULL
);

CREATE TABLE DISPOSITIVOS(
    ID_DISP INT NOT NULL,
    DESCRIPCION_DISP VARCHAR(50) NOT NULL,
    MARCA_DISP TEXT NOT NULL
);

CREATE TABLE ORDENADOR(
    ID_ORDENADOR INT NOT NULL,
    DESCRIPCION_ORD VARCHAR(50) NOT NULL,
    MARCA_ORD TEXT NOT NULL,
    TIPO_ORD TEXT NOT NULL,
    ID_DISP INT NOT NULL
);

CREATE TABLE MOVIL(
    ID_MOVIL INT NOT NULL,
    DESCRIPCION_MOV VARCHAR(50) NOT NULL,
    MARCA_MOV TEXT NOT NULL,
    TIPO_MOV TEXT NOT NULL,
    ID_DISP INT NOT NULL
);

CREATE TABLE ACCESORIOS(
    ID_ACCESORIOS INT NOT NULL,
    DESCRIPCION_ACC VARCHAR(50) NOT NULL,
    MARCA_ACC TEXT NOT NULL,
    TIPO_ACC TEXT NOT NULL,
    ID_DISP INT NOT NULL
);

ALTER TABLE ONG ADD CONSTRAINT pk_ong PRIMARY KEY(ID_ONG);

ALTER TABLE EMPRESA ADD CONSTRAINT pk_empresa PRIMARY KEY(ID_EMPRESA);

ALTER TABLE DEPARTAMENTO ADD CONSTRAINT pk_departamento PRIMARY KEY(ID_DEP);

ALTER TABLE EMPLEADOS ADD CONSTRAINT pk_empleados PRIMARY KEY(ID_EMPLEADOS);

ALTER TABLE REPARA ADD CONSTRAINT pk_repara PRIMARY KEY(ID_EMPLEADOS, ID_DISP);

ALTER TABLE DISPOSITIVOS ADD CONSTRAINT pk_dispositivos PRIMARY KEY(ID_DISP);

ALTER TABLE ORDENADOR ADD CONSTRAINT pk_ordenador PRIMARY KEY(ID_ORDENADOR);

ALTER TABLE MOVIL ADD CONSTRAINT pk_movil PRIMARY KEY(ID_MOVIL);

ALTER TABLE ACCESORIOS ADD CONSTRAINT pk_accesorios PRIMARY KEY(ID_ACCESORIOS);


ALTER TABLE ONG ADD CONSTRAINT fk_ong FOREIGN KEY(ID_EMPRESA) REFERENCES EMPRESA(ID_EMPRESA);

ALTER TABLE DEPARTAMENTO ADD CONSTRAINT fk_departamento FOREIGN KEY(ID_EMPRESA) REFERENCES EMPRESA(ID_EMPRESA);

ALTER TABLE EMPLEADOS ADD CONSTRAINT fk_empleados FOREIGN KEY(ID_DEP) REFERENCES DEPARTAMENTO(ID_DEP);

ALTER TABLE REPARA ADD CONSTRAINT fk_repara_empleados FOREIGN KEY(ID_EMPLEADOS) REFERENCES EMPLEADOS(ID_EMPLEADOS);
ALTER TABLE REPARA ADD CONSTRAINT fk_repara_disp FOREIGN KEY(ID_DISP) REFERENCES DISPOSITIVOS(ID_DISP);

ALTER TABLE ORDENADOR ADD CONSTRAINT fk_ordenador FOREIGN KEY(ID_DISP) REFERENCES DISPOSITIVOS(ID_DISP);

ALTER TABLE MOVIL ADD CONSTRAINT fk_movil FOREIGN KEY(ID_DISP) REFERENCES DISPOSITIVOS(ID_DISP);

ALTER TABLE ACCESORIOS ADD CONSTRAINT fk_accesorios FOREIGN KEY(ID_DISP) REFERENCES DISPOSITIVOS(ID_DISP);